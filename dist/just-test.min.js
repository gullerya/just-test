import*as DataTier from"./libs/data-tier/data-tier.min.js";import{STATUSES}from"./test.js";import{Suite}from"./suite.js";export{createSuite};const initParams={},model=DataTier.ties.create("justTestModel",{passed:0,failed:0,skipped:0,total:0,done:0,suites:[]});function createSuite(e){model.suites.push({name:e.name});const t=new Suite(model.suites[model.suites.length-1]);return t.addEventListener("testAdded",onTestAdded),t.addEventListener("testFinished",onTestFinished),t.addEventListener("finished",onSuiteFinished),t}function onTestAdded(){model.total++}function onTestFinished(e){const t=e.detail.result;model.done++,t===STATUSES.PASSED?model.passed++:t instanceof Error||t===STATUSES.FAILED||t===STATUSES.ERRORED?model.failed++:t===STATUSES.SKIPPED&&model.skipped++}function onSuiteFinished(e){const t=e.detail.suiteModel;if(t.duration=stringifyDuration(t.duration),model.suites.every(e=>e.done===e.tests.length)){const e=document.querySelector("just-test-view");e&&(e.results=model)}}function stringifyDuration(e){let t="";return t=e>99?(e/1e3).toFixed(1)+" s"+String.fromCharCode(160):e>59900?(e/6e4).toFixed(1)+" m"+String.fromCharCode(160):e.toFixed(1)+" ms"}Array.from(new URL(import.meta.url).searchParams).forEach(e=>{initParams[e[0]]=e[1]}),Object.keys(initParams).length?(console.info("JT: init params are as following"),console.dir(initParams)):console.info("JT: no init params found"),initParams.headless||document.querySelectorAll("just-test-view").length||import("./views/just-test-view.js").then(()=>{const e=document.createElement("just-test-view");initParams.minimized&&e.classList.add("minimized"),document.body.appendChild(e)});