export{};const DEFAULT_SUITE_NAME="unnamed",DEFAULT_SYNC_TEST_TTL=1e4,DEFAULT_ASYNC_TEST_TTL=18e5;let view,api={},suites=[];function stringifyDuration(e){return e>99?(e/1e3).toFixed(1)+" s":e>59900?(e/6e4).toFixed(1)+" m":e.toFixed(1)+" ms"}function Test(e,t){let n,i,s,o,a,r,u,l,d,c,p,m,f="idle";n="id"in e?e.id:void 0,i="name"in e?e.name:"not descripted",s="boolean"==typeof e.async&&e.async,o="boolean"==typeof e.skip&&e.skip,a="number"==typeof e.ttl?e.ttl:s?DEFAULT_ASYNC_TEST_TTL:DEFAULT_SYNC_TEST_TTL,(p=document.createElement("div")).className="test",(m=document.createElement("div")).className="title",m.textContent=i,p.appendChild(m),(m=document.createElement("div")).className="duration",p.appendChild(m),(m=document.createElement("div")).className="status "+f,m.onclick=function(){let e,t=p.querySelector(".message");"idle"!==f&&"running"!==f&&(t.offsetHeight>0?(t.classList.remove("scrollable"),t.style.maxHeight="0px"):(t.style.maxHeight="200px",t.addEventListener("transitionend",function e(){this.classList.add("scrollable"),this.removeEventListener("transitionend",e)}),r instanceof Error?(e=r.stack.replace(" at ","<br>"),t.innerHTML=e):t.textContent=r?r.toString():""))},p.appendChild(m),(m=document.createElement("div")).className="message",p.appendChild(m),Object.defineProperties(this,{id:{get:function(){return n}},name:{get:function(){return i}},async:{get:function(){return s}},skip:{get:function(){return o}},ttl:{get:function(){return a}},run:{value:function(){var e,n;function i(e,t){n&&clearInterval(n),d=performance.now(),r=t,f=e,c=d-l,p.querySelector(".status").className="status "+f,p.querySelector(".duration").textContent=stringifyDuration(c),p.querySelector(".message").classList.add(f)}return f="running",p.querySelector(".status").className="status "+f,u=new Date,l=performance.now(),o?(i("skipped",""),Promise.resolve()):((e=new Promise((e,i)=>{n=setTimeout(()=>{i(new Error("Timeout, have you forgotten to call pass/fail?"))},a),t(e,i)})).then(e=>{i("passed",e)},e=>{i("failed",e instanceof Error?e:new Error(e))}),e)}},status:{get:function(){return f}},message:{get:function(){return r}},startTime:{get:function(){return u}},duration:{get:function(){return c}},view:{get:function(){return p}}})}function Suite(e){let t,n,i,s,o,a,r,u,l=[],d=0,c=0,p=0,m="idle";function f(){r.querySelector(".passed").textContent=d,r.querySelector(".failed").textContent=c,r.querySelector(".skipped").textContent=p}"id"in(e="object"==typeof e?e:{})&&(t=e.id),n="name"in e?e.name:DEFAULT_SUITE_NAME,(r=document.createElement("div")).className="suite",(u=document.createElement("div")).className="header",r.appendChild(u),(u=document.createElement("div")).className="title",u.textContent=n,r.firstChild.appendChild(u),(u=document.createElement("div")).className="counters",u.innerHTML='<span class="passed">0</span> | <span class="failed">0</span> | <span class="skipped">0</span> of <span class="total">0</span>',r.firstChild.appendChild(u),(u=document.createElement("div")).className="duration",r.firstChild.appendChild(u),(u=document.createElement("div")).className="status "+m,r.firstChild.appendChild(u),Object.defineProperties(this,{id:{get:function(){return t}},name:{get:function(){return n}},view:{get:function(){return r}},addTest:{value:function(e,t){let n,i="bad parameters: must be 1 or 2 where the last one is a function";if(arguments.length<1||arguments.length>2)throw new Error(i);if(1===arguments.length&&(t=arguments[0],e={}),"function"!=typeof t)throw new Error(i);n=new Test(e,t),r.appendChild(n.view),l.push(n)}},getTests:{value:function(){return l.slice(0)}},run:{value:function(){let e;return m="running",r.querySelector(".header > .status").className="status "+m,r.querySelector(".total").textContent=l.length,e=new Promise(e=>{let t=Promise.resolve();i=new Date,s=performance.now(),function n(i){var u,h;i===l.length?t.then(function(){o=performance.now(),m=c>0?"failed":"passed",a=o-s,r.querySelector(".header > .status").className="status "+m,r.querySelector(".header > .duration").textContent=stringifyDuration(a),e()}):(u=l[i++],(h=u.run()).then(function(){"passed"===u.status?d++:"failed"===u.status?c++:"skipped"===u.status&&p++,f(),!u.async&&n(i)},function(){"passed"===u.status?d++:"failed"===u.status?c++:"skipped"===u.status&&p++,f(),!u.async&&n(i)}),u.async&&(t=t.then(()=>h),n(i)))}(0)})}},status:{get:function(){return m}},startTime:{get:function(){return i}},duration:{get:function(){return a}}})}function buildView(){let e,t,n,i,s,o,a,r,u,l="max";function d(e){let n=t.getElementsByClassName("minMaxToggle")[0];e||(e="min"===l?"max":"min"),"max"===e?(t.classList.remove("min"),t.classList.add("max"),n.textContent="▲",t.lastChild.style.display="block"):(t.classList.remove("max"),t.classList.add("min"),t.lastChild.style.display="none",n.textContent="▼"),l=e}return(e=document.createElement("style")).innerHTML+=".just-test-ui {position:fixed;top:50px;left:350px;background-color:#000;color:#fff;opacity:.7;font-size:20px;font-family:Courier;border-radius:5px;overflow:hidden;cursor:default;box-sizing:border-box;transition: width .2s, height .2s;z-index:99999;}",e.innerHTML+=".just-test-ui.max {height:800px;width:800px;}",e.innerHTML+=".just-test-ui.min {height:35px;width:180px;}",e.innerHTML+=".just-test-ui .title {position:absolute;font-family:Tahoma;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}",e.innerHTML+=".just-test-ui > .minMaxToggle {position:absolute;right:9px;top:3px;font:25px monospace;}",e.innerHTML+=".just-test-ui > .header {top:3px;height:40px;left:5px;right:40px;font-size:24px;color:#99f;}",e.innerHTML+=".just-test-ui > .content {position:absolute;top:40px;bottom:60px;width:100%;border-top:3px solid #99f;overflow-x:hidden;overflow-y:scroll;}",e.innerHTML+=".just-test-ui > .footer {position:absolute;bottom:0px;left:0px;width:100%;height:60px;padding:0px 5px;font-family:Tahoma;border-top:3px solid #99f;}",e.innerHTML+=".just-test-ui .suite {position:relative;width:100%;height:auto;margin:10px 0px 30px;}",e.innerHTML+=".just-test-ui .suite .header {position:relative;height:26px;margin:0px 5px;border-bottom:1px solid #555}",e.innerHTML+=".just-test-ui .suite .header > div {position:absolute;top:0px;}",e.innerHTML+=".just-test-ui .suite .header > .title {width:340px;}",e.innerHTML+=".just-test-ui .suite .header > .counters {left:350px;}",e.innerHTML+=".just-test-ui .suite .header > .status {right:0px;}",e.innerHTML+=".just-test-ui .scrollable {overflow-x:hidden;overflow-y:auto;}",e.innerHTML+=".just-test-ui .duration {right:100px;}",e.innerHTML+=".just-test-ui .running {color:#99f;}",e.innerHTML+=".just-test-ui .skipped {color:#666;}",e.innerHTML+=".just-test-ui .passed {color:#6f4;}",e.innerHTML+=".just-test-ui .failed {color:#f55;}",e.innerHTML+='.just-test-ui .status.idle:before {color:#fff;content:"idle";}',e.innerHTML+='.just-test-ui .status.running:before {content:"running";}',e.innerHTML+='.just-test-ui .status.skipped:before {content:"skipped";}',e.innerHTML+='.just-test-ui .status.passed:before {content:"passed";}',e.innerHTML+='.just-test-ui .status.failed:before {content:"failed";}',e.innerHTML+=".just-test-ui .test {position:relative;min-height:24px;margin:10px 5px 10px 30px;font-size:18px;overflow:hidden;}",e.innerHTML+=".just-test-ui .test > div {position:absolute;top:0px;}",e.innerHTML+=".just-test-ui .test > .title {left:3px;width:500px;}",e.innerHTML+=".just-test-ui .test > .status {right:3px;}",e.innerHTML+=".just-test-ui .test > .status.passed:hover, .just-test-ui .test > .status.failed:hover {border-bottom:1px solid #ccc;}",e.innerHTML+=".just-test-ui .test > .message {position:relative;margin:25px 0px 0px 40px;height:auto;max-height:0px;transition:max-height .2s;line-height:150%;}",document.body.appendChild(e),(t=document.createElement("div")).className="just-test-ui",(i=document.createElement("div")).className="header title",i.textContent="JustTest",i.onmousedown=function(e){u=document.onmousemove,s=e.clientX,o=e.clientY,a=t.offsetLeft,r=t.offsetTop,document.onmousemove=function(e){let n=r+e.clientY-o,i=a+e.clientX-s;n=n<0?0:n,i=i<0?0:i,n=document.documentElement.clientHeight-n-35<0?document.documentElement.clientHeight-35:n,i=document.documentElement.clientWidth-i-180<0?document.documentElement.clientWidth-180:i,t.style.top=n+"px",t.style.left=i+"px",e.preventDefault()},document.onmouseleave=document.onmouseup=function(){document.onmousemove=u}},t.appendChild(i),(i=document.createElement("div")).className="minMaxToggle",i.onclick=function(){d()},t.appendChild(i),(n=document.createElement("div")).className="content",t.appendChild(n),(i=document.createElement("div")).className="footer",i.textContent="Summary:",t.appendChild(i),d("max"),document.body.appendChild(t),{ui:t,appendSuiteView:function(e){n.appendChild(e)}}}Array.from(new URL(import.meta.url).searchParams).forEach(e=>{initParams[e[0]]=e[1]}),Object.keys(initParams).length?(console.info("JT: init params are as following"),console.dir(initParams)):console.info("JT: no init params found"),options&&"object"==typeof options||(options={}),options.namespace&&"object"==typeof options.namespace||("object"!=typeof window.Utils&&Object.defineProperty(window,"Utils",{value:{}}),options.namespace=window.Utils),"configUrl"in options||(options.configUrl="config.js"),view=buildView(),Object.defineProperties(api,{createSuite:{value:function(e){var t=new Suite(e);return suites.push(t),view.appendSuiteView(t.view),t}},View:{value:view}});